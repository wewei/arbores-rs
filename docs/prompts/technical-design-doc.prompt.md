# 技术设计文档编写 Prompt

## 概述

本 Prompt 用于指导技术设计文档的编写，确保文档结构清晰、问题导向、便于 Review 和迭代。

## 编写原则

1. **问题驱动**：先提出关键设计问题，再探索解决方案
2. **分层设计**：复杂模块采用总分结构，简单模块采用扁平结构
3. **接口优先**：重点关注数据结构和函数签名，而非实现细节
4. **迭代完善**：分两阶段编写，第一阶段提问，第二阶段在原文档基础上补充答案

## 文档状态标记

在文档标题下方标注当前状态：
- `状态：Draft-1` - 第一阶段（需求分析 + 问题提出）
- `状态：Draft-2` - 第二阶段（问题回答 + 设计完善）
- `状态：Reviewed` - 已完成 Review

---

## 第一阶段：需求分析与问题提出

### 文档结构选择
- 如果模块复杂，需要拆分子模块，请使用【复杂模块模板】
- 如果模块复杂度适中，请使用【简单模块模板】

### 输出要求
- 重点关注接口设计，不要包含详细实现
- 每个设计问题都要使用指定格式，留待第二阶段解决
- 代码示例只包含数据结构定义和函数签名
- 问题要具体、可操作，避免过于宽泛


### 复杂模块模板

```markdown
# [模块名称]设计

状态：Draft-1

## 概述
[模块的核心职责和在系统中的作用]

## 功能性需求
- [需求1]：[具体描述]
- [需求2]：[具体描述]
- ...

## 非功能性需求（设计目标）
- **[目标1]**：[具体指标或要求]
- **[目标2]**：[具体指标或要求]
- ...

## 架构设计

### 子模块拆分
本模块包含以下子模块：

1. **子模块1** - [职责描述] (详见 `./子模块目录/子模块1_Design.md`)
2. **子模块2** - [职责描述] (详见 `./子模块目录/子模块2_Design.md`)
3. **子模块3** - [职责描述] (详见 `./子模块目录/子模块3_Design.md`)

### 依赖关系
[使用文本图或描述说明子模块依赖关系]

### 数据流
[使用文本描述数据在子模块间的流转过程]

## 核心数据类型
[模块级别的核心数据类型定义，使用 Rust 代码块展示结构]

## 模块级接口
[模块对外提供的主要 API，使用 Rust 代码块展示函数签名]

## 关键设计问题

### 问题：[具体问题1描述]
TODO

### 问题：[具体问题2描述]
TODO

### 问题：[跨子模块问题描述]
TODO

## 参考文献
[参考文献连接列表]
```

### 简单模块模板

```markdown
# [模块名称]设计

状态：Draft-1

## 概述
[模块的核心职责和在系统中的作用]

## 模块职责（功能性需求）
- [职责1]：[具体描述]
- [职责2]：[具体描述]
- ...

## 设计目标（非功能性需求）
- **[目标1]**：[具体指标或要求]
- **[目标2]**：[具体指标或要求]
- ...

## 关键数据类型

### [数据类型1]
[使用 Rust 代码块定义数据类型，只包含结构，不包含实现]

### [数据类型2]
[使用 Rust 代码块定义数据类型]

## 关键功能函数接口

### [功能函数1]

#### 参数列表
| 参数名 | 类型 | 描述 |
|--------|------|------|
| [参数1] | [参数1类型] | 参数1 描述 |
| [参数2] | [参数2类型] | 参数2 描述 |

#### 返回值
| 类型 | 描述 |
|------|------|
| [返回值类型] | 返回值描述 |

### [功能函数2]

#### 参数列表
| 参数名 | 类型 | 描述 |
|--------|------|------|
| [参数1] | [参数1类型] | 参数1 描述 |
| [参数2] | [参数2类型] | 参数2 描述 |

#### 返回值
| 类型 | 描述 |
|------|------|
| [返回值类型] | 返回值描述 |

## 关键设计问题

### 问题：[具体问题1描述]
TODO

### 问题：[具体问题2描述]
TODO

### 问题：[具体问题3描述]
TODO
```

## 第二阶段：在原文档基础上回答设计问题

请在第一阶段设计文档的基础上进行以下修改：

## 输入材料
- 第一阶段设计文档：[文档路径]
- Review 反馈：[反馈内容]

## 修改要求
1. 将文档状态从 `状态：Draft-1` 更新为 `状态：Draft-2`
2. 找到所有 `### 问题：[描述]` 下的 `TODO`，替换为具体答案
3. 根据 Review 反馈调整相关的数据结构和接口定义
4. 如果有新发现的设计问题，可以添加新的问题

## TODO 替换说明
将每个问题下的 `TODO` 替换为具体的设计方案和答案，格式不限，按需组织内容。

## 注意事项
- 保持原文档的所有结构和内容不变
- 只替换 TODO 部分，不要修改问题描述
- 如果某个问题暂时无法确定，可以保留 TODO 并说明原因
