# 边界情况和错误处理测试 fixture

test_cases:
  - name: "nested_quotes"
    description: "嵌套引用"
    input: "''x"
    expected: |
      (
        quote   #; (0 1)
        (
          quote #; (1 2)
          x     #; (2 3)
        )       #; (1 3)
      )         #; (0 3)

  - name: "mixed_quotes"
    description: "混合引用类型"
    input: "'`,@x"
    expected: |
      (
        quote                #; (0 1)
        (
          quasiquote         #; (1 2)
          (
            unquote-splicing #; (2 4)
            x                #; (4 5)
          )                  #; (2 5)
        )                    #; (1 5)
      )                      #; (0 5)

  - name: "deeply_nested_list"
    description: "深度嵌套列表"
    input: "(((())))"
    expected: |
      (
        (
          (
            () #; (3 5)
          )    #; (2 6)
        )      #; (1 7)
      )        #; (0 8)

  - name: "list_with_many_elements"
    description: "多元素列表"
    input: "(a b c d e f g h i j)"
    expected: |
      (
        a #; (1 2)
        b #; (3 4)
        c #; (5 6)
        d #; (7 8)
        e #; (9 10)
        f #; (11 12)
        g #; (13 14)
        h #; (15 16)
        i #; (17 18)
        j #; (19 20)
      )   #; (0 21)

  - name: "complex_dotted_structure"
    description: "复杂点对结构"
    input: "(a b . (c d . e))"
    expected: |
      (
        a #; (1 2)
        b #; (3 4)
        c #; (8 9)
        d #; (10 11)
        .
        e #; (0 0)
      )   #; (0 17)

  - name: "zero_and_negative_numbers"
    description: "零和负数"
    input: "(0 -1 -3.14)"
    expected: |
      (
        0     #; (1 2)
        -1    #; (3 5)
        -3.14 #; (6 11)
      )       #; (0 12)

  - name: "special_characters_in_symbols"
    description: "符号中的特殊字符"
    input: "(+ - * / = < > <= >= eq? null?)"
    expected: |
      (
        +     #; (1 2)
        -     #; (3 4)
        *     #; (5 6)
        /     #; (7 8)
        =     #; (9 10)
        <     #; (11 12)
        >     #; (13 14)
        <=    #; (15 17)
        >=    #; (18 20)
        eq?   #; (21 24)
        null? #; (25 30)
      )       #; (0 31)

  - name: "character_literals"
    description: "字符字面量"
    input: "(#\\a #\\space #\\newline #\\tab)"
    expected: |
      (
        #\a       #; (1 4)
        #\space   #; (5 12)
        #\newline #; (13 22)
        #\tab     #; (23 28)
      )           #; (0 29)

  - name: "mixed_number_formats"
    description: "混合数字格式"
    input: "(42 3.14 0 -5 -2.5)"
    expected: |
      (
        42   #; (1 3)
        3.14 #; (4 8)
        0    #; (9 10)
        -5   #; (11 13)
        -2.5 #; (14 18)
      )      #; (0 19)

  - name: "vector_with_many_elements"
    description: "多元素向量"
    input: "#(a b c d e f g h i j)"
    expected: |
      #(
        a #; (2 3)
        b #; (4 5)
        c #; (6 7)
        d #; (8 9)
        e #; (10 11)
        f #; (12 13)
        g #; (14 15)
        h #; (16 17)
        i #; (18 19)
        j #; (20 21)
      )   #; (0 22)

  - name: "mixed_vector_content"
    description: "混合内容向量"
    input: "#(42 \"hello\" #t (a b) #(1 2))"
    expected: |
      #(
        42      #; (2 4)
        "hello" #; (5 12)
        #t      #; (13 15)
        (
          a     #; (17 18)
          b     #; (19 20)
        )       #; (16 21)
        #(
          1     #; (24 25)
          2     #; (26 27)
        )       #; (22 28)
      )         #; (0 29)

  - name: "vector_in_list"
    description: "列表中的向量"
    input: "(list #(1 2 3) #(a b))"
    expected: |
      (
        list #; (1 5)
        #(
          1  #; (8 9)
          2  #; (10 11)
          3  #; (12 13)
        )    #; (6 14)
        #(
          a  #; (17 18)
          b  #; (19 20)
        )    #; (15 21)
      )      #; (0 22)

  - name: "empty_strings_and_symbols"
    description: "空字符串"
    input: "\"\""
    expected: "\"\" #; (0 2)"

  - name: "string_with_all_escapes"
    description: "包含所有转义字符的字符串"
    input: "\"\\\"\\\\\\n\\t\\r\""
    expected: "\"\\\"\\\\\\n\\t\\r\" #; (0 12)"

error_cases:
  - name: "unclosed_paren"
    description: "未闭合的括号"
    input: "(define x"
    should_fail: true

  - name: "extra_closing_paren"
    description: "多余的闭合括号"
    input: "(define x 42))"
    should_fail: true

  - name: "unclosed_string"
    description: "未闭合的字符串"
    input: "\"hello"
    should_fail: true

  - name: "invalid_dot_syntax"
    description: "无效的点语法"
    input: "(. a)"
    should_fail: true

  - name: "multiple_dots"
    description: "多个点"
    input: "(a . b . c)"
    should_fail: true

